<?xml version="1.0"?>
<launch>

  <!-- Bring up the platform in sim with all models, controllers, sensors estimates -->
  <node pkg="si_utils" type="timed_roslaunch"
        args="1 movo_object_search environment.launch"
        name="sim_bringup" output="screen"/>
  
  <!-- Bring up the joystick for control -->
  <node pkg="si_utils" type="timed_roslaunch"
        args="7 movo_remote_teleop movo_remote_teleop.launch"
        name="joy_bringup" output="screen"/>

  <!-- Bring up the moveit -->
  <node if="$(optenv MOVO_HAS_KINOVA_ARM_6DOF false)" pkg="si_utils" type="timed_roslaunch"
        args="10 movo_moveit_config movo_moveit_planning_execution.launch sim:=true info:=true"
        name="moveit_bringup" output="screen"/>
  
  <node if="$(optenv MOVO_HAS_KINOVA_ARM_7DOF false)" pkg="si_utils" type="timed_roslaunch"
        args="10 movo_7dof_moveit_config movo_moveit_planning_execution.launch sim:=true info:=true"
        name="moveit_bringup" output="screen"/>

  <!-- Bring up the demo -->
  <node pkg="si_utils" type="timed_roslaunch"
        args="18 movo_gazebo init_sim.xml"
        name="init_sim_bringup" output="screen"/>  

  <!-- marker detector -->
  <node pkg="aruco_ros" type="marker_publisher"  name="aruco_marker_publisher">
    <remap from="/camera_info"       to="/movo_camera/sd/camera_info" />
    <remap from="/image"             to="/movo_camera/sd/image_color" />
    <param name="image_is_rectified" value="True"/>
    <param name="marker_size"        value="0.1778"/>
    <param name="reference_frame"    value="base_link"/>   <!-- frame in which the marker pose will be expressed -->
    <param name="camera_frame"       value="movo_camera_ir_optical_frame"/>
    <param name="marker_frame"       value="aruco_frame" />
    <param name="corner_refinement"  value="SUBPIX" />
  </node>
  
  
</launch>
